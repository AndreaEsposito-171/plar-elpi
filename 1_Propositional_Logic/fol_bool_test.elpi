%%% ===========================================================================
%%% Boolean interpretation.
%%% ===========================================================================

accumulate lib.
accumulate formula.
accumulate prop.
accumulate fol.
accumulate testing.

%%% ---------------------------------------------------------------------------
%%% Language.
%%% ---------------------------------------------------------------------------

type zero, one term.
type add, mul term -> term -> term.
type eq term -> term -> formula.

%%% ---------------------------------------------------------------------------
%%% Model.
%%% ---------------------------------------------------------------------------

domain [ff, tt].

termval zero ff.
termval one tt.
termval (add X Y) B :- orb  {termval X} {termval Y} B.
termval (mul X Y) B :- andb {termval X} {termval Y} B.

holds (eq X Y) B :- iffb {termval X} {termval Y} B.

%%% ---------------------------------------------------------------------------
%%% Run tests.
%%% ---------------------------------------------------------------------------

shorten testing.{ run-tests, ok, ko, okb, kob, ok-eq, section }.

main :-
    with-verbosity quiet (run-tests
    [ section "Fol bool"
    , okb (holds/c (ctx X\ ctx Y\ formula/c (eq (add X Y) (add Y X))))
    ]).
