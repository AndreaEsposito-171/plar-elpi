%%% ===========================================================================
%%% Tests for formula.
%%% ===========================================================================

accumulate lib.
accumulate formula.
accumulate verbosity.
accumulate test.

type p, q, r formula.

atomic P :- std.mem! [p,q,r] P.

%%% ---------------------------------------------------------------------------
%%% Run tests.
%%% ---------------------------------------------------------------------------

shorten test.{ run-tests, ok, ko, okb, kob, ok-eq, section }.
shorten verbosity.{ quiet, terse, info, verbose, debug, with-verbosity }.

main :-
    with-verbosity quiet (run-tests
    [ section "Test copy/fm"
    , (ok-eq (q && r !! r) R \
         [ (copy/fm p q :- !)
         , (copy/fm q r :- !)
         , (pi X\ copy/fm X X :- atomic X)
         ] => copy/fm (p && q !! r) R)
    , section "Test onatoms"
    , (ok-eq (r && q !! p) R \
         pi F\
         [ (F p r :- !)
         , (F r p :- !)
         , (pi X\ F X X)
         ] => onatoms F (p && q !! r) R)
    , section "Test atoms"
    , ok-eq [p, q, r] (atoms (p && q !! r))
    ]).
